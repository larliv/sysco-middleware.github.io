I"B<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/AsynchronousCall_OSB11g.jpg" alt="Fire and Forget call in OSB 11g" /></p>

<p><strong>Requirement:</strong></p>

<p>As an requirement client wanted to trigger the Integration (Oracle Service Bus 11g) in “Fire and Forget” manner or asynchronous manner. Just the option to trigger the OSB to start executing without any waiting for process to finish.
In our case we had an integration which did some processing of data from the database couple of times and saving it to the Topic which took some time (in this case just a couple of minutes). But that was not something that the client side wanted to wait to finish and it didn’t need to wait. Specification was that they want to trigger our proxy service in the scheduled times.</p>

<p><strong>Solution:</strong></p>

<p>We already had implemented logic in the Proxy Service which takes some time to finish the process. Reason for that is that we had to call DB multiple times and it had a lot of data. So, if we call our Proxy Service directly we would need to wait until whole process is complete to get a response back. We know that asynchronous call can be achieved with additional Queue as a recommended solution in OSB 11g, but we didn’t want to have another one, because our integration already has one JMS queue and one topic.
First thing I have tried is to call our Proxy with another Proxy from the same project. But that of course didn’t work.</p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/AsynchronousCall_OSB11g_Fail.jpg" alt="" /></p>

<p>But, then I created additional Business Service in between these two Proxy services which worked for us and did the desired effect.</p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/AsynchronousCall_OSB11g.jpg" alt="" /></p>

<p>Now I will show how did I simply set my Proxy and Business services in OSB 11g. First let’s start with the Business service which was really simple.
For Service Type I used <strong>Messaging Service</strong> and for Request Message Type: <strong>Text</strong> and Response Message Type: <strong>None</strong>. As last thing is to set Endpoint URI to point to your Proxy service you want to invoke (in our case that is long running Proxy). The rest of the setup is default.</p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/BusinessServiceTrigger_1.jpg" alt="" /></p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/BusinessServiceTrigger_2.jpg" alt="" /></p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/BusinessServiceTrigger_3.jpg" alt="" /></p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/BusinessServiceTrigger_4.jpg" alt="" /></p>

<p>For the Proxy service I used a custom made WSDL so I can trigger this from SoapUI as well. But it should work with the Messaging Service option as well because we don’t use any data in the request.</p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/ProxyServiceTrigger_1.jpg" alt="" /></p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/ProxyServiceTrigger_2.jpg" alt="" /></p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/ProxyServiceTrigger_3.jpg" alt="" /></p>

<p>In the message flow all you need is a Publish activity to call our business service we created first.</p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/ProxyMessageFlow.jpg" alt="" /></p>

<p>But, to mimic OK response back to the client and that the service was actually called we have to add two Insert activities in the Response pipeline of our Proxy.
First insert should add the http response code in the response element of the transport variable.</p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/Instert_1.jpg" alt="" /></p>

<p>Second insert should add the text to the response message.</p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/Instert_2.jpg" alt="" /></p>

<p>Your integration is now ready for deployment and a test.</p>

<p><strong>Test:</strong></p>

<p>To test the trigger from the SoapUI create the SoapUI project and run the test:</p>

<p><img src="/images/2018-04-30-Fire-and-Forget-or-asynchronous-Proxy-service-call-in-Oracle-Service-Bus-11g/SoapUI_Testing.jpg" alt="" /></p>

<p>You will not get the response in the XML instead you have to click on the Raw tab to see the response header from the service and here you see the response was OK.</p>

<p><strong>Triggering with cURL command:</strong></p>

<p>Our requirement was to call (trigger) the OSB in scheduled times during the day. We found that cURL command will do the job for us and with cURL it can be triggered from the external system which was responsible for triggering schedule. I will not go into details of curl command but in this case should be self explanatory:</p>

<p><strong>curl -X POST http://localhost/int/TestPro/ProxyServiceTrigger –data-binary “@../request.xml” –header “SOAPAction: process”  -H “Content-Type: text/xml;charset=UTF-8”</strong></p>

<p><strong>request.xml</strong> file from the command has the content:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;soapenv:Envelope</span> <span class="na">xmlns:phar=</span><span class="s">"http://xmlns.oracle.com/int_TestPro/TriggerInstructionGenerator_v1/InstructionGeneratorProcess"</span> <span class="na">xmlns:soapenv=</span><span class="s">"http://schemas.xmlsoap.org/soap/envelope/"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;soapenv:Header&gt;</span>
		<span class="nt">&lt;wsse:Security</span> <span class="na">soapenv:mustUnderstand=</span><span class="s">"0"</span> <span class="na">xmlns:wsse=</span><span class="s">"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;wsse:UsernameToken</span> <span class="na">wsu:Id=</span><span class="s">"UsernameToken-34141130"</span> <span class="na">xmlns:wsu=</span><span class="s">"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;wsse:Username&gt;</span>TestUser<span class="nt">&lt;/wsse:Username&gt;</span>
				<span class="nt">&lt;wsse:Password</span> <span class="na">Type=</span><span class="s">"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText"</span><span class="nt">&gt;</span>435e678af7b2245ef0f15412f<span class="nt">&lt;/wsse:Password&gt;</span>
			<span class="nt">&lt;/wsse:UsernameToken&gt;</span>
		<span class="nt">&lt;/wsse:Security&gt;</span>
	<span class="nt">&lt;/soapenv:Header&gt;</span>
	<span class="nt">&lt;soapenv:Body&gt;</span>
		<span class="nt">&lt;phar:process&gt;</span>
		<span class="nt">&lt;/phar:process&gt;</span>
	<span class="nt">&lt;/soapenv:Body&gt;</span>
<span class="nt">&lt;/soapenv:Envelope&gt;</span>
</code></pre></div></div>

<p>Save the file where the cURL command will be executed from and has access to.</p>

:ET