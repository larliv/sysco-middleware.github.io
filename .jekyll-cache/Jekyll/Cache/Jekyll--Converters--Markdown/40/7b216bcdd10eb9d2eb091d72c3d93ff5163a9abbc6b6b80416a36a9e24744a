I""<p>Now we will learn how to change the sql statement for Database pollers using OSB 12c.
There we go:</p>

<h2 id="introduction">Introduction</h2>

<p>OSB allows us to create DbAdapters and select a polling functionality, but there are some restrictions if we want to write a custom sql statement. <br />
There is a nice way to set a pure sql statement for polling database rows and after reading operation. I will show you how to handle it.</p>

<h2 id="create-poller">Create poller</h2>

<p>First, we have to create a dbAdapter on proxy services and select “Poll for New or Changed Records in a Table”.</p>

<ul>
  <li><img src="/images/2015-10-29-create-custom-sql-statements-pollers-OSB-12c/createPoller.jpg" alt="" /></li>
</ul>

<p>In the “After Read” step select “Delete the Row(s) that were Read” option like the image below:</p>

<ul>
  <li><img src="/images/2015-10-29-create-custom-sql-statements-pollers-OSB-12c/createDeletePoller.jpg" alt="" /></li>
</ul>

<p>If you are using clusters then select Distributed Polling (FOR UPDATE SKIP LOCKED) . This will help to avoid record locking issues.</p>

<ul>
  <li><img src="/images/2015-10-29-create-custom-sql-statements-pollers-OSB-12c/distributedPolling.jpg" alt="" /></li>
</ul>

<h2 id="edit-poller">Edit poller</h2>

<p>Then it will create 6 files and one of them finishes in -or-mapping.xml, this file is protected, so you have to open in another text editor.
Inside of this file you can set the pure sql for the poller and after reading operations.</p>

<p>To set poller sql statement:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;querying&gt;</span>
	<span class="nt">&lt;queries&gt;</span>
		 <span class="nt">&lt;query</span> <span class="na">name=</span><span class="s">"TestPoller"</span> <span class="na">xsi:type=</span><span class="s">"read-all-query"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;call</span> <span class="na">xsi:type=</span><span class="s">"sql-call"</span><span class="nt">&gt;</span>
				<span class="nt">&lt;sql&gt;</span>Pure SQL statement<span class="nt">&lt;/sql&gt;</span>
			<span class="nt">&lt;/call&gt;</span>
		<span class="nt">&lt;/query&gt;</span>
	<span class="nt">&lt;/queries&gt;</span>
 <span class="nt">&lt;/querying&gt;</span>
</code></pre></div></div>

<p>To set pure sql after read</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	.
	.
	.
	<span class="nt">&lt;/queries&gt;</span>
	<span class="nt">&lt;delete-query</span> <span class="na">xsi:type=</span><span class="s">"delete-object-query"</span><span class="nt">&gt;</span>
		<span class="nt">&lt;call</span> <span class="na">xsi:type=</span><span class="s">"sql-call"</span><span class="nt">&gt;</span>
			<span class="nt">&lt;sql&gt;</span>After read SQL statement<span class="nt">&lt;/sql&gt;</span>
		<span class="nt">&lt;/call&gt;</span>
	<span class="nt">&lt;/delete-query&gt;</span>
<span class="nt">&lt;/querying&gt;</span>
</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>

<p>Basicaly, we can execute any pure sql statement selecting this option in the DbAdapter. <br />
When we select this option we will not delete some row if we add these codes to overwrite the delete function with another sql statement.</p>

:ET