I"<p>One of the external systems is using web services with WS-Addressing to retrieve Login information for the user in this case it is a token number. After which this token number will be used when calling other web services from that system.</p>

<p>So to call this web service from Oracle Service Bus 12c we need to create correct SOAP headers to enable the WS-Addressing callout.</p>

<h2 id="short-overview-of-ws-addressing">Short overview of WS-Addressing</h2>

<p>WS-Addressing provides a transport-neutral mechanism to address Web services and their associated messages. Using WS-Addressing, endpoints are uniquely and unambiguously defined in the SOAP header.
WS-Addressing provides two key components that enable transport-neutral addressing, including:</p>

<ul>
  <li><strong>Endpoint reference (EPR)</strong> - Communicates the information required to address a Web service endpoint.</li>
  <li><strong>Message addressing properties</strong> - Communicates end-to-end message characteristics, including addressing for source and destination endpoints and message identity, that allows uniform addressing of messages independent of the underlying transport.</li>
</ul>

<p><em>Example message with WS-Addressing - Request Message:</em></p>

<p><img src="/images/2016-12-22-How_to_call_web_service_that_uses_WS-Addressing_from_OSB_12c/WS-AddressingSampleMessage.png" alt="" /></p>

<h2 id="example-of-soapui-call-to-the-web-service-with-ws-addressing">Example of SoapUI call to the web service with WS-Addressing.</h2>

<p>For this example I will use SoapUI 5.2.1. Calling a service with WS-A from SoapUI is fairly simple, just configure all necessary Message addressing properties for the SOAP Headers. In my case which worked for me, you can see in the image below. That options you can find by clicking on the tab “WS-A” beneath the request message window.</p>

<p><img src="/images/2016-12-22-How_to_call_web_service_that_uses_WS-Addressing_from_OSB_12c/WS-AddressingSoapUI.jpg" alt="" /></p>

<p>Here you can also see a simple request message that I will be using trough this post.
Now when all is configured we can call the service.</p>

<p><img src="/images/2016-12-22-How_to_call_web_service_that_uses_WS-Addressing_from_OSB_12c/WS-AddressingSoapUI_Response.jpg" alt="" /></p>

<p>Now the service call was successful and the response gave as a Token, which was essentially the objective.
As you can see this was pretty easy to do with SoapUI, now we need this exact response in Oracle Service Bus 12c.</p>

<h2 id="web-service-callout-with-ws-a-from-osb-12c">Web service callout with WS-A from OSB 12c</h2>

<p>To do a WS-A service call on Service Bus 12c we need to replicate the Message addressing properties in the Service Callout from the pipeline of our project.
First step is to create a Business Service from the web service’s WSDL and URI address. Then we can create a Service Callout in the pipeline of our Oracle Service Bas 12c project. In the Service Callout we select the Business service just created and chose the correct operation that will be used in case you have more than one.</p>

<p>Next step is to select the ‘Configure Body’ as the configuration option and create mandatory variables for Body Request/Response and plus create variables for Header Request/Response. Header variables will be used to add the SOAP headers used for WS-Addressing call.</p>

<p><img src="/images/2016-12-22-How_to_call_web_service_that_uses_WS-Addressing_from_OSB_12c/WS-Addressing_OSB12c.jpg" alt="" /></p>

<p>As a last step add Assign activities for the Header and Body request variables.</p>

<p><img src="/images/2016-12-22-How_to_call_web_service_that_uses_WS-Addressing_from_OSB_12c/WS-Addressing_OSB12c_2.jpg" alt="" /></p>

<p><img src="/images/2016-12-22-How_to_call_web_service_that_uses_WS-Addressing_from_OSB_12c/WS-Addressing_OSB12c_3.jpg" alt="" /></p>

<p>LoginWSA_ReqHeader:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;soap-env:Header</span> <span class="na">xmlns:wsa=</span><span class="s">"http://www.w3.org/2005/08/addressing"</span> <span class="na">xmlns:soap=</span><span class="s">"http://www.w3.org/2003/05/soap-envelope"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;wsa:Action</span> <span class="na">soap:mustUnderstand=</span><span class="s">"1"</span><span class="nt">&gt;</span>http://tempuri.org/AuthenticationService/LogInUser<span class="nt">&lt;/wsa:Action&gt;</span>
	<span class="nt">&lt;wsa:To</span> <span class="na">soap:mustUnderstand=</span><span class="s">"1"</span><span class="nt">&gt;</span>http://websrv1u.com/SecurityES.WS/services/Security.ServiceFacade.AuthenticationService.svc<span class="nt">&lt;/wsa:To&gt;</span>
<span class="nt">&lt;/soap-env:Header&gt;</span>
</code></pre></div></div>

<p>LoginWSA_RequestBody:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;soapenv:Body</span> <span class="na">xmlns:soapenv=</span><span class="s">"http://schemas.xmlsoap.org/soap/envelope/"</span> <span class="na">xmlns:tem=</span><span class="s">"http://tempuri.org/"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;tem:LogInUser&gt;</span>
	 	<span class="nt">&lt;tem:userName&gt;</span>OSB12c<span class="nt">&lt;/tem:userName&gt;</span>
		<span class="nt">&lt;tem:password&gt;</span>Pass@25462<span class="nt">&lt;/tem:password&gt;</span>
	<span class="nt">&lt;/tem:LogInUser&gt;</span>
<span class="nt">&lt;/soapenv:Body&gt;</span>
</code></pre></div></div>

<p>Optional:
If you need to add some more properties you can use Transport Header activity and add it as http Content-Type property inside the header for example:
Content-Type:</p>

<p>‘application/soap+xml;charset=UTF-8;action=”http://tempuri.org/AuthenticationService/LogInUser”’</p>

<p>Now your final service callout should look like this:</p>

<p><img src="/images/2016-12-22-How_to_call_web_service_that_uses_WS-Addressing_from_OSB_12c/WS-Addressing_OSB12c_4.jpg" alt="" /></p>

<p>Now you can deploy and test your Service Bus 12c project and service call with WS-Addressing.
For this example the WS-A service response looks like this:</p>

<p><img src="/images/2016-12-22-How_to_call_web_service_that_uses_WS-Addressing_from_OSB_12c/WS-Addressing_OSB12c_5.jpg" alt="" /></p>

:ET